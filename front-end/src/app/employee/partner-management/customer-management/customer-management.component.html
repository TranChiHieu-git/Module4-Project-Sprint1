<link href="//netdna.bootstrapcdn.com/font-awesome/3.1.1/css/font-awesome.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>


<!-- Load Facebook SDK for JavaScript -->
<div id="fb-root"></div>
<!-- Your Chat Plugin code -->
<div class="fb-customerchat"
     attribution=setup_tool
     page_id="100944425041334"
     theme_color="#0084ff"
     logged_in_greeting="Hi! Code Bakery có thể hỗ trợ gì cho bạn?"
     logged_out_greeting="Hi! Code Bakery có thể hỗ trợ gì cho bạn?">
</div>

<div>
  <h2>Danh sách khách hàng</h2>
  <div>
    <input class="form-control mr-3 " type="text" [(ngModel)]="search" placeholder="Search..."
           style="width: 400px; height: 100%">
    <button class="btn btn-outline-primary" (click)="searchName()">Tìm kiếm</button>
    <!--    <button *ngIf="isSearch === true" class="btn btn-outline-danger ml-1" (click)="backToSearch()">Quay về</button>-->
  </div>
</div>
<div class="mt-3">
  <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#addModel">Thêm mới</button>
  <table class="table table-bordered" style="font-size: 12px;">
    <thead class="bg-secondary">
    <tr class="row px-3">
      <th scope="col" class="col-md-2">Mã</th>
      <th scope="col" class="col-md-3">Tên</th>
      <th scope="col" class="col-md-3">Địa chỉ</th>
      <th scope="col" class="col-md-2">Email</th>
      <th scope="col" class="col-md-2">Chức Năng</th>
    </tr>
    </thead>
    <tbody>
    <tr class="row px-3" *ngFor=" let user of users ">
      <td class="col-md-2">
        <button type="button" class="btn btn-info" data-toggle="collapse" [attr.data-target]="'#demo'+user.id"
                class="border-0 bg-transparent icon-row">
          <i class="fa fa-plus-circle" aria-hidden="true"></i>
        </button>
        {{user.id}}
      </td>
      <td class="col-md-3"> {{user.userName}}</td>
      <td class="col-md-3"> {{user.address}}</td>
      <td class="col-md-2"> {{user.email}}</td>
      <td class="col-md-2" style="width: auto">
        <button type="button" class="btn btn-warning"><a data-toggle="modal" data-target="#editModal"
                                                         (click)="editModel(user)">Sửa</a></button>
        <button type="button" class="btn btn-danger"><a data-toggle="modal" data-target="#DeleteModal"
                                                        (click)="deleteModel(user)">Xóa</a></button>
      </td>
      <div id="demo{{user.id}}" class="row collapse px-3 w-100">
        <p></p>
        <span class="col-md-4 h-50">So lan da mua hang : {{user.listOrder.length}}</span>
        <span class="col-md-4">Tổng giá trị hàng đã mua: {{getSumTotal(user)}} </span>
        <span class="col-md-4">Mã chiết khấu: 1122</span>
      </div>
    </tr>
    </tbody>
  </table>
  <nav aria-label="Page navigation example">
    <ul class="pagination">
      <li class="page-item" (click)="onFirst()"><a class="page-link">First</a></li>
      <li class="page-item" (click)="onPrevious()" [ngClass]="pageClicked==0?'disabled':''">
        <a class="page-link">Previous</a>
      </li>
      <li *ngIf="pageClicked != 0" class="page-item" (click)="onSubmit(pages[pageClicked-1])">
        <a class="page-link">{{pageClicked}}</a>
      </li>
      <li [ngClass]="(pageClicked == pages[pageClicked]) ? 'active' : ''" class="page-item"
          (click)="onSubmit(pages[pageClicked-1])">
        <a class="page-link">{{pageClicked + 1}}</a>
      </li>
      <li *ngIf="pageClicked < pages.length -1" class="page-item" (click)="onSubmit(pages[pageClicked-1])">
        <a class="page-link">{{pageClicked + 2}}</a>
      </li>
      <li *ngIf="pageClicked < pages.length -2" class="page-item">
        <a class="page-link">...</a>
      </li>
      <li *ngIf="pageClicked < pages.length-2" class="page-item" (click)="onLast()">
        <a class="page-link">{{pages[pages.length - 1] + 1}}</a>
      </li>
      <li class="page-item" (click)="onNext()" [ngClass]="pageClicked==totalPages-1?'disabled':''">
        <a class="page-link">Next</a>
      </li>
      <li class="page-item" (click)="onLast()"><a class="page-link">Last</a></li>
    </ul>
  </nav>
</div>


<!--Add Modal-->
<div class="modal fade " id="addModel" tabindex="-1" role="dialog"
     aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title modal-titles labelAdd" id="editModalLabel">Thêm thông tin khách hàng</h5>
        <button type="button" class="close " data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form (ngSubmit)="onSubmit(pages[pageClicked-1])" [formGroup]="addUser">
          <div class="col-xl-4 form-group">
            <mat-card (mouseover)="hoverUploadPic()" class="mat-card-img" (mouseleave)="leaveUploadPic()"
                      (click)="selectAvatar()">
              <img  class="zz" id="avatar" src="../../../../assets/photo/customer-avatar.png" alt="avatar">
              <input  readonly class="file-upload-input" type='file' id="image" (change)="readURL($event.target);" accept="image/*" hidden
                     id="myAvatar"/>

              <i class="img"
                 style="font-size: 100px; color: blue; position: absolute; left: 60px; top:60px ; opacity: 0.1"
                 class="icon-upload-alt"></i>
            </mat-card>
          </div>
          <div class="customer-input-outside form-group">
            <input class="global-content-popup-input customer-input form-control" id="name1" formControlName="userName"
                   type="text"
                   placeholder="Ten khach hang"/>
            <label class="global-content-popup-icon" for="name1"><i class="icon-user"></i></label>
            <div *ngFor="let validation of validationMessages.fullName">
                    <span class="global-content-popup-validate customer-validate"
                          *ngIf="addUser.get('userName').hasError(validation.type) && (addUser.get('userName').dirty || addUser.get('userName').touched)">
        {{validation.message}}></span>
            </div>

          </div>
          <div class="customer-input-outside form-group ">
            <div><i class="icon-tag "></i>
              <div class="form-check-inline">
                <label class="" for="nam"><input type="radio" id="nam" name="gender"
                                                 class="form-check-input" formControlName="gender"
                                                 value="Nam" checked>Nam</label></div>
              <div class="form-check-inline">
                <label class="" for="nu"><input type="radio" id="nu" name="gender"
                                                class="form-check-input" formControlName="gender"
                                                value="Nữ">Nữ</label></div>
            </div>
            <span *ngIf="addUser.controls.gender.errors?.required && addUser.controls.address.touched"> Vui lòng chọn giới tính</span>
          </div>

          <div class="customer-input-outside form-group">
            <input class="global-content-popup-input customer-input " formControlName="address" id="name2" type="text"
                   placeholder="Địa chỉ"/>
            <label class="global-content-popup-icon" for="name2"><i class="icon-map-marker"></i></label>
            <span class="global-content-popup-validate customer-validate"
                  *ngIf="addUser.controls.address.errors?.required && addUser.controls.address.touched">Không được để trống</span>
          </div>

          <div class="customer-input-outside form-group">
            <mat-form-field class="matFromField">
              <input [max]="maxDate" [min]="minDate" matInput [matDatepicker]="myDatepicker" class="form-control"
                     formControlName="birthday" placeholder="Chọn ngày sinh">
              <mat-datepicker-toggle matSuffix [for]="myDatepicker"></mat-datepicker-toggle>
              <mat-datepicker #myDatepicker></mat-datepicker>
              <div *ngFor="let validation of validationMessages.birthday">
                <mat-error class="error-message"
                           *ngIf="addUser.get('birthday').hasError(validation.type) && (addUser.get('birthday').dirty || addUser.get('birthday').touched)">
                  {{validation.message}}</mat-error>
              </div>
            </mat-form-field>
          </div>

          <div class="customer-input-outside form-group">
            <input class="global-content-popup-input customer-input form-control" type="text" id="name4"
                   formControlName="phone" placeholder="Số điện thoại"/>

            <label class="global-content-popup-icon" for="name4"><i class="icon-phone"></i></label>
            <div *ngFor="let validation of validationMessages.phone">  <span
              class="global-content-popup-validate customer-validate"
              *ngIf="addUser.get('phone').hasError(validation.type) && (addUser.get('phone').dirty || addUser.get('phone').touched)">
            {{validation.message}}> </span></div>
          </div>

          <div class="customer-input-outside form-group">
            <input class="global-content-popup-input customer-input form-control" type="text" id="name5"
                   formControlName="email" placeholder="Email"/>

            <label class="global-content-popup-icon" for="name5"><i class="icon-envelope-alt"></i></label>
            <div *ngFor="let validation of validationMessages.email">    <span
              class="global-content-popup-validate customer-validate"
              *ngIf="addUser.get('email').hasError(validation.type) && (addUser.get('email').dirty || addUser.get('email').touched)">
          {{validation.message}}></span></div>
          </div>
          <!--          <div class="customer-input-outside form-group">-->
          <!--              <div>-->
          <!--                <input class="" type='file' (change)="readURL($event.target);" accept="image/*"-->
          <!--                       id="myAvatar">-->
          <!--              </div>-->
          <!--          </div>-->
          <!--          <div class="custom-file">-->
          <!--            <input type="file" class="custom-file-input" id="customFile">-->
          <!--              <label class="custom-file-label" for="customFile">Choose file</label>-->
          <!--          </div>-->
          <!--          <input type="submit" value="Luu" [disabled]="studentForm.invalid">-->
        </form>
        <button type="button" class="global-button edit-customer-btn1"><a data-toggle="modal"
                                                                          (click)="addCheckModal()">Thêm</a>
        </button>
      </div>

      <!-- Modal add check-->
      <div class="modal fade" id="addCheckModal" tabindex="-1" role="dialog" aria-labelledby="addCheckModalLabel"
           aria-hidden="true">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="addCheckModalLabel" class="text-success">Message!!!</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
              Đã thêm mới thành công ...
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-dismiss="modal" (click)="backMenu()">Ok</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

  <!--      &lt;!&ndash;       Modal edit&ndash;&gt;-->
  <!--      <div class="modal fade" id="editModal" tabindex="-1" role="dialog" aria-labelledby="editModalLabel"-->
  <!--           aria-hidden="true">-->
  <!--        <div class="modal-dialog" role="document">-->
  <!--          <div class="modal-content">-->
  <!--            <div class="modal-header">-->
  <!--              <h5 class="modal-title modal-titles" id="editModalLabel">Sửa thông tin khách hàng</h5>-->
  <!--              <button type="button" class="close " data-dismiss="modal" aria-label="Close">-->
  <!--                <span aria-hidden="true">&times;</span>-->
  <!--              </button>-->
  <!--            </div>-->
  <!--            <div class="modal-body">-->
  <!--              <form (ngSubmit)="editSubmit(tempCustomer.userName)" [formGroup]="addUser">-->
  <!--                <div class="customer-input-outside">-->
  <!--                  <input class="global-content-popup-input customer-input" type="text" id="userName"-->
  <!--                         formControlName="userName"/>-->
  <!--                  <label class="global-content-popup-icon" for="userName"><i class="icon-user"></i></label>-->

  <!--                  <p class="global-content-popup-validate customer-validate" *ngIf="editUser.get('userName').hasError('required')-->
  <!--                        && editUser.get('userName').touched">Tên khách hàng không được để trống!</p>-->
  <!--                  <p class="global-content-popup-validate customer-validate" *ngIf="editUser.get('userName').hasError('pattern')-->
  <!--                        && editUser.get('userName').touched">Tên khách khàng không được chứa kí tự đặc biệt!</p>-->

  <!--                </div>-->

  <!--                <div class="customer-input-outside">-->
  <!--                  &lt;!&ndash;                  <input class="global-content-popup-input customer-input" type="text" id="birthday" formControlName="birthday"/>&ndash;&gt;-->

  <!--                  <div class="datePicker">-->
  <!--                    <input style="width: 57%;margin-right: 35%;" class="global-content-popup-input customer-input"-->
  <!--                           type="text"-->
  <!--                           id="birthday" formControlName="birthday" readonly matInput [matDatepicker]="picker"-->
  <!--                           (dateInput)="addEvent($event)">-->
  <!--                    <div class="datePicker-div">-->
  <!--                      <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>-->
  <!--                      <mat-datepicker #picker></mat-datepicker>-->
  <!--                    </div>-->
  <!--                  </div>-->
  <!--                  <label class="global-content-popup-icon" for="birthday"><i class="icon-calendar"></i></label>-->


  <!--                  <div class="select-gender">-->
  <!--                    <select formControlName="gender" id="gender" style="height:40px">-->
  <!--                      <option value="Nam" [selected]="tempCustomer.gender=='Nam'">Nam</option>-->
  <!--                      <option value="Nữ" [selected]="tempCustomer.gender=='Nữ'">Nữ</option>-->
  <!--                    </select>-->
  <!--                    <label class="global-content-popup-icon" for="gender"><i class="fa fa-venus-mars"></i></label>-->
  <!--                  </div>-->
  <!--                </div>-->

  <!--                <div class="customer-input-outside">-->
  <!--                  <input class="global-content-popup-input customer-input" type="text" id="address"-->
  <!--                         formControlName="address"/>-->

  <!--                  <label class="global-content-popup-icon" for="address"><i class="icon-map-marker"></i></label>-->
  <!--                  <p class="global-content-popup-validate customer-validate" *ngIf="addUser.get('address').hasError('required')-->
  <!--                        && editUser.get('address').touched">Địa chỉ không được để trống!</p>-->
  <!--                </div>-->

  <!--                <div class="customer-input-outside">-->
  <!--                  <input class="global-content-popup-input customer-input" type="text" id="email"-->
  <!--                         formControlName="email"/>-->

  <!--                  <label class="global-content-popup-icon" for="email"><i class="icon-envelope-alt"></i></label>-->
  <!--                  <p class="global-content-popup-validate customer-validate" *ngIf="editUser.get('email').hasError('required')-->
  <!--                        && editUser.get('email').touched">Email không được để trống!</p>-->
  <!--                  <p class="global-content-popup-validate customer-validate" *ngIf="editUser.get('email').hasError('pattern')-->
  <!--                        && editUser.get('email').touched">Email không đúng định dạng (ví dụ: son.94@gmail.com)</p>-->
  <!--                </div>-->

  <!--                <div class="customer-input-outside">-->
  <!--                  <input class="global-content-popup-input customer-input" type="text" id="phone"-->
  <!--                         formControlName="phone"/>-->

  <!--                  <label class="global-content-popup-icon" for="phone"><i class="icon-phone"></i></label>-->
  <!--                  <p class="global-content-popup-validate customer-validate" *ngIf="editUser.get('phone').hasError('required')-->
  <!--                        && editUser.get('phone').touched">Số điện thoại không được để trống</p>-->
  <!--                  <p class="global-content-popup-validate customer-validate" *ngIf="editUser.get('phone').hasError('pattern')-->
  <!--                        && editUser.get('phone').touched">Số điện thoại không đúng định dạng-->
  <!--                    (090xxxxxxx or 091xxxxxxx or (84)+90xxxxxxx or (84)+91xxxxxxx, x là số)</p>-->
  <!--                </div>-->


  <!--                <input class="global-button edit-customer-btn1" type="submit" value="Sửa" [disabled]="editUser.invalid">-->
  <!--                <input class="global-button-cancel edit-customer-btn2" type="button" data-dismiss="modal" value="Hủy">-->

  <!--                &lt;!&ndash;                <div class="card">&ndash;&gt;-->
  <!--                &lt;!&ndash;                  <img src="{{tempCustomer.imageUrl}}" id="img-preview" class="avatar"/>&ndash;&gt;-->
  <!--                &lt;!&ndash;                  <label class="file-upload-container" for="file-upload">&ndash;&gt;-->
  <!--                &lt;!&ndash;                    <input id="file-upload" (change)="onFileSelected($event)" type="file" style="display:none;">&ndash;&gt;-->
  <!--                &lt;!&ndash;                    Đổi ảnh đại diện&ndash;&gt;-->
  <!--                &lt;!&ndash;                  </label>&ndash;&gt;-->
  <!--                &lt;!&ndash;                  <button type="button" (click)="onUpload()">upload</button>&ndash;&gt;-->
  <!--                &lt;!&ndash;                </div>&ndash;&gt;-->
  <!--                <div class="card">-->
  <!--                  <mat-card (mouseover)="hoverUploadPic()" class="mat-card-img" (mouseleave)="leaveUploadPic()"-->
  <!--                            (click)="selectAvatar()">-->
  <!--                    <img id="avatar" src={{tempCustomer.imageUrl}}>-->
  <!--                    <input formControlName="id" readonly hidden>-->
  <!--                    <input class="file-upload-input" type='file'-->
  <!--                           (change)="readURL($event.target);" accept="image/*"-->
  <!--                           hidden id="myAvatar" style="display:none;"/>-->
  <!--                    <i class="img img-upload-icon icon-upload-alt"></i>-->
  <!--                  </mat-card>-->
  <!--                  <progress max="100" [value]="(uploadProgress | async)" *ngIf="uploadProgressStatus"></progress>-->
  <!--                </div>-->
  <!--              </form>-->

  <!--            </div>-->
  <!--          </div>-->
  <!--        </div>-->
  <!--      </div>-->
  <router-outlet></router-outlet>
