<div class="row justify-content-between m-3">
  <h2><span class="fa fa-bars"></span> Danh sách thương hiệu</h2>
  <div class="form-group has-search mr-2">
    <span class="fa fa-search form-control-feedback"></span>
    <input type="text" class="form-control searchInput" placeholder="Search" name="search" [(ngModel)]="search"
           (ngModelChange)="searchName()">
  </div>
</div>
<hr>
<div class="row mt-3 px-3">
  <div>
    <button class="btn btn-primary ml-3" data-toggle="modal" data-target="#createBrand"><span
      class="fa fa-plus-square"></span> Thêm mới
    </button>
  </div>
<!--  Test Checkbox-->
  <button type="button" class="btn btn-primary delete-selected" (click)="deleteManyBrand()">Xóa những thương hiệu đã chọn</button>
  <div class="container-fluid">
    <form [formGroup]="brandEditForm" (ngSubmit)="edit()">
      <table class="table table-bordered mt-3 table-striped">
        <thead class="table-header">
        <tr>
          <th class="">Hình ảnh</th>
          <th class="" (click)="sort('id')">Mã Thương Hiệu <i class="fa fa-sort" aria-hidden="true"></i></th>
          <th class="">Tên Thương Hiệu</th>
          <th class="">Trụ sở</th>
          <th class="">Website</th>
          <th class="">Sửa | Xóa</th>
<!--          Test Checkbox-->
          <th scope="col">
            <div class="custom-control custom-checkbox" style="margin: 0 36%;">
              <input type="checkbox" name="checkbox" (click)="deleteAllCheckbox($event)" class="custom-control-input"
                     id="checkAll">
              <label class="custom-control-label" for="checkAll"></label>
            </div>

          </th>
        </tr>
        </thead>
        <tbody>
        <tr *ngFor="let brand of brandList | orderBy: key: !reverse">
          <td *ngIf="brand.isEditable">
            <div>
              <img class="brand-image" [src]="imgSrc">
              <input formControlName="brandLogo" type="text" hidden [(ngModel)]="imgSrc">
            </div>
            <div>
              <input style="display: none" type="file" name="myImage" accept="image/*"
                     #fileUploader
                     (change)="onFileSelected($event)">
              <button type="button" class="btn btn-primary" (click)="fileUploader.click()">Chọn ảnh</button>
            </div>

          </td>
          <td *ngIf="!brand.isEditable" style="width: 150px">
            <img class="brand-logo" [src]="brand.brandLogo">
          </td>
          <td>
            <p>{{brand.id}}</p>
          </td>

          <td *ngIf="brand.isEditable">
            <div class="input-group">
              <input formControlName="brandName" type="text" class="edit-input form-control" placeholder="Tên thương hiệu (*)" [(ngModel)]="brand.brandName">
            </div>
            <p class="text-danger"
               *ngIf="brandEditForm.get('brandName').hasError('required') && brandEditForm.get('brandName').touched">
              Tên thương hiệu không được để trống!
            </p>
          </td>
          <td *ngIf="!brand.isEditable">
            <p>{{brand.brandName}}</p>
          </td>

          <td *ngIf="brand.isEditable">
            <div class="input-group">
              <input formControlName="brandAddress" type="text" class="edit-input form-control" placeholder="Trụ sở thương hiệu (*)" [(ngModel)]="brand.brandAddress">
            </div>
            <p class="text-danger"
               *ngIf="brandEditForm.get('brandAddress').hasError('required') && brandEditForm.get('brandAddress').touched">
              Trụ sở thương hiệu không được để trống!
            </p>
          </td>
          <td *ngIf="!brand.isEditable">
            <p>{{brand.brandAddress}}</p>
          </td>

          <td *ngIf="brand.isEditable">
            <div class="input-group">
              <input formControlName="brandWebsite" type="text" class="edit-input form-control" placeholder="Website thương hiệu (*)"  [(ngModel)]="brand.brandWebsite">
            </div>
            <p class="text-danger"
               *ngIf="brandEditForm.get('brandWebsite').hasError('required') && brandEditForm.get('brandWebsite').touched">
              Website thương hiệu không được để trống!
            </p>
          </td>
          <td *ngIf="!brand.isEditable">
            <p>{{brand.brandWebsite}}</p>
          </td>
          <td style="text-align: center">
            <button class="border-0 mr-3 bg-transparent fas fa-pencil-alt test"
                    (click)="brand.isEditable=!brand.isEditable; catchBrandId(brand.id)"
                    *ngIf="!brand.isEditable"></button>
            <button class="border-0 mr-3 bg-transparent fas fa-check"
                    *ngIf="brand.isEditable" [disabled]="brandEditForm.invalid" (click)="switchEdit(brand); "></button>
            <button hidden type="submit" id="submit{{brand.id}}" (click)="showSuccess()"></button>

            <button type="button" class="border-0 bg-transparent fa fa-trash" data-toggle="modal"
                    (click)="catchBrandId(brand.id)"
                    data-target="#brandConfirmDelete"></button>
          </td>
<!--Test checkbox-->
          <td class="">
            <div class="custom-control custom-checkbox" style="margin: 0 34%;">
              <input type="checkbox" name="checkbox" [value]="brand.id" (change)="deleteCheckbox($event,brand.id)"
                     class="custom-control-input" id="{{brand.id}}">
              <label class="custom-control-label" for="{{brand.id}}"></label>
            </div>

          </td>
        </tr>
        </tbody>
      </table>
    </form>
  </div>
</div>

<div class="row mt-3">
  <div class="paging-brand">
    <nav aria-label="Page navigation example">
      <ul class="pagination">
        <li class="page-item" (click)="onFirst()"><a class="page-link">First</a></li>
        <li class="page-item" (click)="onPrevious()" [ngClass]="pageClick==0?'disabled':''">
          <a class="page-link">Previous</a>
        </li>
        <li *ngIf="pageClick != 0" class="page-item" (click)="onSubmit(pages[pageClick-1])">
          <a class="page-link">{{pageClick}}</a>
        </li>
        <li [ngClass]="(pageClick == pages[pageClick]) ? 'active' : ''" class="page-item"
            (click)="onSubmit(pages[pageClick])">
          <a class="page-link">{{pageClick + 1}}</a>
        </li>
        <li *ngIf="pageClick < pages.length -1" class="page-item" (click)="onSubmit(pages[pageClick+1])">
          <a class="page-link">{{pageClick + 2}}</a>
        </li>
        <li *ngIf="pageClick < pages.length -2" class="page-item">
          <a class="page-link">...</a>
        </li>
        <li *ngIf="pageClick < pages.length-2" class="page-item" (click)="onLast()">
          <a class="page-link">{{pages[pages.length - 1] + 1}}</a>
        </li>
        <li class="page-item" (click)="onNext()" [ngClass]="pageClick==totalPages-1?'disabled':''">
          <a class="page-link">Next</a>
        </li>
        <li class="page-item" (click)="onLast()"><a class="page-link">Last</a></li>
      </ul>
    </nav>
  </div>
</div>
<!-- Modal Create Brand -->
<div class="modal fade" id="createBrand" tabindex="-1" role="dialog"
     aria-hidden="true" data-backdrop="static">
  <div class="custom-modal modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">Thêm thương hiệu</h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form [formGroup]="brandForm" (ngSubmit)="addNewBrand()">
          <div class="row d-flex justify-content-between">
            <div class="col-4 text-center">
              <div>
                <img class="brand-image" [src]="imgSrc">
              </div>
              <div>
                <input style="display: none" type="file" name="myImage" accept="image/*"
                       #fileUploader
                       (change)="onFileSelected($event)">
                <button type="button" class="btn btn-primary" (click)="fileUploader.click()">Chọn ảnh</button>
              </div>
            </div>

            <div class="col-8">
              <input formControlName="brandLogo" type="text" hidden [(ngModel)]="imgSrc">
              <div class="input-group mb-3">
                <div class="input-group-prepend">
                  <span class="input-group-text"><i class="fa fa-id-card-o fa-lg" aria-hidden="true"></i></span>
                </div>
                <input formControlName="brandName" type="text" class="form-control" placeholder="Brand name (*)">
              </div>
              <p class="text-danger ml-2"
                 *ngIf="brandForm.get('brandName').hasError('required') && brandForm.get('brandName').touched">
                Tên thương hiệu không được để trống!
              </p>
              <div class="input-group mb-3">
                <div class="input-group-prepend">
                  <span class="input-group-text"><i class="fa fa-map-marker fa-lg" aria-hidden="true"></i></span>
                </div>
                <input formControlName="brandAddress" type="text" class="form-control" placeholder="Brand address (*)">
              </div>
              <p class="text-danger ml-2"
                 *ngIf="brandForm.get('brandAddress').hasError('required') && brandForm.get('brandAddress').touched">
                Trụ sở thương hiệu không được để trống!
              </p>
              <div class="input-group mb-3">
                <div class="input-group-prepend">
                  <span class=" input-group-text"><i class="fa fa-globe fa-lg " aria-hidden="true"></i></span>
                  <span class=" input-group-text"><i class="fa fa-globe fa-lg add-brand-ico "
                                                     aria-hidden="true"></i></span>
                </div>
                <input formControlName="brandWebsite" type="text" class="form-control" placeholder="Website (*)">
              </div>
              <p class="text-danger ml-2"
                 *ngIf="brandForm.get('brandWebsite').hasError('required') && brandForm.get('brandWebsite').touched">
                Website thương hiệu không được để trống!
              </p>
            </div>
          </div>
          <div class="modal-footer d-flex justify-content-center">
            <button class="btn btn-warning #createBrand ">
              Xác nhận
            </button>
            <button class="btn btn-secondary " data-dismiss="modal">Hủy</button>

          </div>
        </form>
      </div>

    </div>
  </div>
</div>

<!--Modal Confirm Delete Brand-->

<div class="modal fade" id="brandConfirmDelete" data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog"
     aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title headerText" id="staticLabel">Xác nhận xóa thương hiệu</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <p class="modal-body" style="text-align: center">
        Bạn có chắc chắn xóa thương hiệu <span class="text-danger font-weight-bold">{{brandName}}</span> không?
      </p>
      <div class="modal-footer justify-content-center">
        <button type="button" class="btn btn-danger" (click)="delete()">Xác Nhận</button>
        <button type="button" class="btn btn-secondary" id="close" data-dismiss="modal">Hủy</button>
      </div>
    </div>
  </div>
</div>
